<%- include('../layouts/layout', {
    title: 'Household Profiling - Step 3',
    bodyClass: 'd-flex flex-column min-vh-100 bg-light',
    headerType: 'survey',
    extraStyles: `
        <style>
            .form-card { background: white; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
            .section-title { color: #457507; font-weight: 600; position: relative; padding-bottom: 10px; margin-bottom: 20px; }
            .section-title::after { content: ''; position: absolute; bottom: 0; left: 0; width: 60px; height: 3px; background: linear-gradient(90deg, #457507, #6ba32a); border-radius: 2px; }
            .form-label { font-weight: 500; color: #444; margin-bottom: 6px; }
            .form-control, .form-select { border-radius: 10px; border: 1.5px solid #e0e0e0; padding: 12px 16px; transition: all 0.2s ease; }
            .form-control:focus, .form-select:focus { border-color: #457507; box-shadow: 0 0 0 4px rgba(69, 117, 7, 0.1); }
            .btn-modern { padding: 12px 32px; border-radius: 25px; font-weight: 600; transition: all 0.3s ease; }
            .btn-church-modern { background: linear-gradient(135deg, #457507 0%, #5a8f1a 100%); color: white; border: none; }
            .btn-church-modern:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(69, 117, 7, 0.35); color: white; }
        </style>
    `,
    body: `
        <main class="flex-fill py-4">
            <div class="container">
                <div class="mb-4">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <span class="text-muted fw-medium">Step 3 of 4</span>
                        <span class="text-muted">Health & Living Conditions</span>
                    </div>
                    <div class="progress-custom" style="height: 8px; border-radius: 4px; background: #e9ecef;">
                        <div class="progress-bar" role="progressbar" style="width: 75%; background: linear-gradient(90deg, #457507, #6ba32a); border-radius: 4px;"></div>
                    </div>
                </div>
                
                <form action="" method="POST">
                    <div class="form-card p-4 mb-4">
                        <h4 class="section-title">Health & Treatment</h4>
                        <div class="row g-4">
                            <div class="col-md-4">
                                <label class="form-label">Common illnesses in the Household (last 3 months)</label>
                                <select name="common_illness" id="illness" class="form-select">
                                    <option value="">Select Illness</option>
                                    <option value="00">None</option>
                                    <option value="01">Fever</option>
                                    <option value="02">Flu</option>
                                    <option value="03">Cough</option>
                                    <option value="04">Cold</option>
                                    <option value="05">Diarrhea</option>
                                    <option value="06">Cholera</option>
                                    <option value="07">Asthma</option>
                                    <option value="08">Typhoid Fever</option>
                                    <option value="09">Dengue</option>
                                    <option value="10">Pneumonia</option>
                                    <option value="11">Chicken Pox</option>
                                    <option value="12">Measles</option>
                                    <option value="13">Heart Disease</option>
                                    <option value="14">Lung Disease</option>
                                    <option value="15">High Blood</option>
                                    <option value="16">Anemia</option>
                                    <option value="17">Malaria</option>
                                    <option value="99">Others</option>
                                </select>
                                <input type="text" name="common_illness_others" class="form-control mt-2" placeholder="If others, specify">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Where do household go for treatment?</label>
                                <select name="treatment_source" id="treatment" class="form-select">
                                    <option value="">Select Facility</option>
                                    <option value="00">None</option>
                                    <option value="01">Traditional Healers</option>
                                    <option value="02">Private Doctors</option>
                                    <option value="03">RHU Doctors</option>
                                    <option value="04">Self-medication</option>
                                    <option value="05">Brgy. Health Station</option>
                                    <option value="06">Rural Health Unit</option>
                                    <option value="07">Brgy. Health Worker</option>
                                    <option value="08">Brgy. Nutrition Scholar</option>
                                    <option value="09">CBHP/DHW</option>
                                    <option value="10">Private Clinic</option>
                                    <option value="99">Others</option>
                                </select>
                                <input type="text" name="treatment_source_others" class="form-control mt-2" placeholder="If others, specify">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Source of potable water</label>
                                <select name="water_source" id="water" class="form-select">
                                    <option value="">Select Water Source</option>
                                    <option value="1">Local Water System</option>
                                    <option value="2">Spring Water</option>
                                    <option value="3">River</option>
                                    <option value="4">Open Well</option>
                                    <option value="5">Own Artesian Well</option>
                                    <option value="6">Community Artesian Well</option>
                                    <option value="7">Community Faucet</option>
                                    <option value="8">Electric Deep Well</option>
                                    <option value="9">Free Flowing Water Pipe</option>
                                    <option value="10">Rain Water</option>
                                    <option value="11">Water Refilling Station</option>
                                    <option value="12">NAWASA</option>
                                    <option value="99">Others</option>
                                </select>
                                <input type="text" name="water_source_others" class="form-control mt-2" placeholder="If others, specify">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-card p-4 mb-4">
                        <h4 class="section-title">Energy & Utilities</h4>
                        <div class="row g-4">
                            <div class="col-md-4">
                                <label class="form-label">Household lighting energy source</label>
                                <select name="lighting_source" id="lighting" class="form-select">
                                    <option value="">Select Lighting Source</option>
                                    <option value="1">Electricity</option>
                                    <option value="2">Kerosene (Gaas)</option>
                                    <option value="3">Liquified Petroleum Gas (LPG)</option>
                                    <option value="4">Solar Panel / Solar Lamp</option>
                                    <option value="5">Battery</option>
                                    <option value="6">Generator</option>
                                    <option value="7">None</option>
                                    <option value="99">Others</option>
                                </select>
                                <input type="text" name="lighting_others" class="form-control mt-2" placeholder="If others, specify">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Household cooking energy source</label>
                                <select name="cooking_source" id="cooking" class="form-select">
                                    <option value="1">Woods</option>
                                    <option value="2">Charcoal</option>
                                    <option value="3">Kerosene (Gas)</option>
                                    <option value="4">Liquefied Petroleum Gas (LPG)</option>
                                    <option value="5">Electricity</option>
                                    <option value="99">Others</option>
                                </select>
                                <input type="text" name="cooking_others" class="form-control mt-2" placeholder="If others, specify">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Way of disposing Household Garbage</label>
                                <select name="garbage_disposal" id="garbage" class="form-select">
                                    <option value="">Select Waste Disposal Method</option>
                                    <option value="1">Segregating Waste</option>
                                    <option value="2">Collected by Garbage Truck</option>
                                    <option value="3">Recycling / Reusing at Home</option>
                                    <option value="4">Selling / Giving Away Recyclables</option>
                                    <option value="5">Composting</option>
                                    <option value="6">Burning</option>
                                    <option value="7">Dumping in Pit with Cover</option>
                                    <option value="8">Dumping in Pit without Cover</option>
                                    <option value="9">Throwing in Uninhabited Locations</option>
                                    <option value="99">Others</option>
                                </select>
                                <input type="text" name="garbage_others" class="form-control mt-2" placeholder="If others, specify">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-card p-4 mb-4">
                        <h4 class="section-title">Sanitation</h4>
                        <div class="row g-4">
                            <div class="col-md-6">
                                <label class="form-label">Toilet facility of the household</label>
                                <select name="toilet_type" id="toilet" class="form-select">
                                    <option value="">Select Toilet Type</option>
                                    <option value="1">Water-Sealed Flush to Sewerage System / Septic Tank (Own Use)</option>
                                    <option value="2">Water-Sealed Flush to Sewerage / Septic Tank (Shared with Other Households)</option>
                                    <option value="3">Closed Pit</option>
                                    <option value="4">Open Pit</option>
                                    <option value="5">No Toilet</option>
                                    <option value="99">Others</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Distance of toilet from water source</label>
                                <select name="toilet_distance" id="toilet_dist" class="form-select">
                                    <option value="1">Below 200 meters</option>
                                    <option value="2">201-500 meters</option>
                                    <option value="3">502-700 meters</option>
                                    <option value="4">701-1000 meters</option>
                                    <option value="5">More than 1000 meters</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-flex justify-content-between mt-4">
                        <button type="button" onclick="goPrev()" class="btn btn-outline-secondary btn-modern">Back</button>
                        <button type="button" onclick="goNext()" class="btn btn-church-modern btn-modern">Continue</button>
                    </div>
                    
                    <input type="hidden" name="form_source" value="health_and_living_conditions">
                </form>
            </div>
        </main>
    `,
    extraScripts: `
        <script>
        function saveFormData() {
            const form = document.querySelector('form');
            const formData = new FormData(form);
            const data = {};
            for (const [key, value] of formData.entries()) {
                data[key] = value;
            }
            sessionStorage.setItem('survey_health', JSON.stringify(data));
        }
        function goNext() { saveFormData(); window.location.href = '/survey5'; }
        function goPrev() { saveFormData(); window.location.href = '/survey2'; }
        document.addEventListener('DOMContentLoaded', () => {
            const saved = JSON.parse(sessionStorage.getItem('survey_health') || '{}');
            for (const key in saved) {
                const el = document.querySelector('[name="' + key + '"]');
                if (el) el.value = saved[key];
            }
        });
        </script>
        <script src="/javascripts/survey4.js"></script>
    `
}) %>